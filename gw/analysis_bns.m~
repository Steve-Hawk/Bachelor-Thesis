%% BINARY NEUTRON star
%
%% units
G     = 6.674e-11;       % m^3/(kg s^2)
c     = 299792458 ;      % m/s
M_sun = 1.98892e30 ;     % kg
mu0   = 1.2566370614e-6; % Newton/Ampere^2
Kb    = 1.3806488e-23 ;  % Joule/K
Mparsec = 3.08567758e19; % km 

CU_to_km   = M_sun*G/(1000*c*c) ;                 % km
CU_to_ms   = (1000*M_sun*G/(c*c*c));              % ms
CU_to_s    = (M_sun*G/(c*c*c))      ;             % s
CU_to_dens = c*c*c*c*c*c / (G*G*G * M_sun*M_sun); % kg/m^3

CU_to_energy    = M_sun*c*c  ;        % kg m^2/s^2

%% GW importing
t_h_psi = gw_strain('../nsnstohmns/mp_Psi4_l2_m2_r300.00.asc',300);
cwt(t_h_psi(:,2),'bump',Fs);
%% positions importing
H=positions_f('../nsnstohmns/rho_max_loc.csv')
A = H(:,2);
B= -H(:,2);
hold on
%plot(A(:,1),A(:,3),'.')
F=[A, B]
plot(A(:,1),F,'-')
%%
d = load('Right Grievous SampleData.mat');
x = d.x(:,1);
y = d.x(:,2);
t = d.x(:,3);
dx = gradient(x, 0.1);
dy = gradient(y, 0.1);
dt = gradient(t);
hdc = pi/2;                             % Critical Heading Change
hdg = atan2(dy,dx);                     % Heading
sec = 2;                                % ?Look Ahead? Time (sec)
dhdg = filter([1 zeros(1,sec*10-2) 1], 2, hdg);
hdgidx = find(abs(dhdg) >= hdc);        % Find ?dhdg? >= pi/2
figure(1)
plot3(x, y, t)
hold on
plot3(x(hdgidx), y(hdgidx), t(hdgidx), '.r')
hold off
grid on

%%
% time
t = pos(:,1);
% positions on the x-y plane
y = pos(:,3);
x = pos(:,2);
hold on;
     plot(x, y,'r.')  

     plot(-x,-y,'b.');
     figure();
     hold on;
     plot(t,x)
     plot(t,-x)
%% positions max density rho


%%
% moltiplicare per 110 e dividere per 100Mpc
x = importdata('mp_Psi4_l2_m2_r300.00.asc', ' ');
% time in solar masses
t = x(:,1);
% sepctrum
figure();
plot(t,fft(d(:,1)));
hold on;
plot(t,fft(d(:,2)));

% energy balance
% variable in the integral over the angles proportional to the energy
int_var = diff(d(:,1)).^2 + diff(d(:,2)).^2;
figure();
plot(t(2:end),int_var,'.')